package SQL;

import java.sql.Connection;
import java.sql.*;

public class CreateTables {
	

	
	
	String createUserTable = "CREATE TABLE k_ulm_FP_Users (" +
			"UserID INT, " +
			"UserName VARCHAR(255), " +
			"UserEmail VARCHAR(255), " + 
			"UserFristName VARCHAR(255), " +
			"UserLastName VARCHAR(255), " + 
			"UserPassword VARCHAR(255), " +
			"AccountCreatedOn Date," +
			"IsAdmin VARCHAR(255))";
	
	
	
	String createFermentablesTable = "CREATE TABLE k_ulm_FP_Fermentables (" +
			"FermentablesID INT NOT NULL PRIMARY KEY, " +
			"FermentablesName VARCHAR(255), " +
			"Catagory VARCHAR(255), " +
			"CategoryDisplay VARCHAR(255), " +
			"Description TEXT, " +
			"CharacteristicsID VARCHAR(255), " +
			"CharacteristicsName VARCHAR(255),"  +
			"CharacteristicsDescription VARCHAR(255), " +
			"CountryIsoCode VARCHAR(255), " +
			"CountryName VARCHAR(255) )";
	
	
	
	public String getCreateUserTableScript() {
		return createUserTable;
	}
	
	public String getCreateFermTableScript() {
		return createFermentablesTable;
	}
	
	

	public void runCreateStatment(Connection conn, String sqlStatment){
		
		 Statement stmt = null;
		
		 try{
			 stmt = conn.createStatement();
			 	 
			 stmt.executeUpdate(sqlStatment);
			 
			 System.out.println("Created table...");
			 
		 }catch(SQLException se){
			 //Handle errors for JDBC
			 se.printStackTrace();
			 
		 }catch(Exception e){
			 //Handle errors for Class.forName
			 e.printStackTrace();
		 }
				
	}
	
	public Boolean SeeIfTableExisits(Connection conn,String tableName){
		
		Boolean doesTableExists = false;
		
		System.out.println("Table Name test " + tableName);
		
		 try{
				DatabaseMetaData md = conn.getMetaData();
				ResultSet rs = md.getTables(null, null, "%", null);

				while (rs.next()) {
					
					if (rs.getString(3).equals(tableName)){
						
						doesTableExists = true;
						System.out.println("Table Already Exists");
					}
				}
		 }catch(SQLException se){
			 //Handle errors for JDBC
			 se.printStackTrace();
			 
		 }catch(Exception e){
			 //Handle errors for Class.forName
			 e.printStackTrace();
		 }
		
		return doesTableExists;
	}

}
